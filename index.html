<script>
    const RAW_DATA = [
        [1210,1,7,9,17,27,38,31],[1209,2,17,20,35,37,39,24],[1208,6,27,30,36,38,42,25],[1207,10,22,24,27,38,45,11],
        [1206,1,3,17,26,27,42,23],[1205,1,4,16,23,31,41,2],[1204,8,16,28,30,31,44,27],[1203,3,6,18,29,35,39,24],
        [1202,5,12,21,33,37,40,7],[1201,7,9,24,27,35,36,37],[1200,1,2,4,16,20,32,45],[1199,16,24,25,30,31,32,7],
        [1198,26,30,33,38,39,41,21],[1197,1,5,7,26,28,43,30],[1196,8,12,15,29,40,45,14],[1195,3,15,27,33,34,36,37],
        [1194,3,13,15,24,33,37,2],[1193,6,9,16,19,24,28,17],[1192,10,16,23,36,39,40,11],[1191,1,4,11,12,20,41,2],
        [1190,7,9,19,23,26,45,33],[1189,9,19,29,35,37,38,31],[1188,3,4,12,19,22,27,9],[1187,5,13,26,29,37,40,42],
        [1186,2,8,13,16,23,28,35],[1185,6,17,22,28,29,32,38],[1184,14,16,23,25,31,37,42],[1183,4,15,17,23,27,36,31],
        [1182,1,13,21,25,28,31,22],[1181,8,10,14,20,33,41,28],[1180,6,12,18,37,40,41,3],[1179,3,16,18,24,40,44,21],
        [1178,5,6,11,27,43,44,17],[1177,3,7,15,16,19,43,21],[1176,7,9,11,21,30,35,29],[1175,3,4,6,8,32,42,31],
        [1174,8,11,14,17,36,39,22],[1173,1,5,18,20,30,35,3],[1172,7,9,24,40,42,44,45],[1171,3,6,7,11,12,17,19],
        [1170,3,13,28,34,38,42,25],[1169,5,12,24,26,39,42,20],[1168,9,21,24,30,33,37,29],[1167,8,23,31,35,39,40,24],
        [1166,14,23,25,27,29,42,16]
    ];

    let basket2 = [], top15 = [], bonusRanked = [];

    function init() {
        let stats = Array(46).fill(0);
        let allAppear = new Set();
        
        // ë°ì´í„° ì§‘ê³„
        RAW_DATA.forEach(d => { 
            d.slice(1,7).forEach(n => { 
                allAppear.add(Number(n)); 
                stats[n]++; 
            }); 
        });
        
        // ë¯¸ì¶œìˆ˜ ì¶”ì¶œ
        basket2 = [];
        for(let i=1; i<=45; i++) { if(!allAppear.has(i)) basket2.push(i); }

        // ê°€ì¤‘ì¹˜ ê³„ì‚° (1210íšŒì°¨ ê¸°ì¤€)
        let weights = [...stats];
        const lastWin = [1, 7, 9, 17, 27, 38];
        lastWin.forEach(n => {
            weights[n] += 10; 
            if(n > 1) weights[n-1] += 5;
            if(n < 45) weights[n+1] += 5;
            let mirror = 46 - n;
            if(mirror <= 45) weights[mirror] += 12;
        });

        // ìƒìœ„ ì¶”ì²œìˆ˜ 15ê°œ ê°ì²´ ì •ë ¬ ë°©ì‹ìœ¼ë¡œ ì¶”ì¶œ (ì˜¤ë¥˜ ë°©ì§€)
        top15 = weights.map((w, i) => ({idx: i, val: w}))
                       .slice(1)
                       .sort((a, b) => b.val - a.val)
                       .slice(0, 15)
                       .map(item => item.idx);
        
        let bStats = {};
        RAW_DATA.forEach(d => { bStats[d[7]] = (bStats[d[7]] || 0) + 1; });
        bonusRanked = Object.keys(bStats).map(Number).sort((a,b) => bStats[b] - bStats[a]);
    }

    function getAC(arr) {
        let diffs = new Set();
        for(let i=0; i<6; i++) { for(let j=i+1; j<6; j++) diffs.add(Math.abs(arr[i]-arr[j])); }
        return diffs.size - 5;
    }

    function process() {
        init();
        const box = document.getElementById('console');
        box.innerHTML = `<div class="stat-line">ğŸš€ ë¶„ì„ ì—”ì§„ ìµœì í™” ì™„ë£Œ (v6.3)</div>`;
        
        let count = 0;
        let safety = 0;

        while(count < 10 && safety < 100000) {
            safety++;
            let res = [];
            
            // ë²ˆí˜¸ êµ¬ì„±: ì¶”ì²œìˆ˜(top15)ì—ì„œ 4ê°œ ì¶”ì¶œ + ë‚˜ë¨¸ì§€ ëœë¤
            let pool = [...top15];
            while(res.length < 4) {
                let rIdx = Math.floor(Math.random() * pool.length);
                res.push(pool.splice(rIdx, 1)[0]);
            }
            
            while(res.length < 6) {
                let pick = Math.floor(Math.random() * 45) + 1;
                if(!res.includes(pick)) res.push(pick);
            }
            res.sort((a,b) => a-b);
            
            const sum = res.reduce((a,b)=>a+b, 0);
            const ac = getAC(res);
            
            // í•„í„°ë§ ì™„í™”: ì—”ì§„ ê°€ë™ ì†ë„ ìµœìš°ì„ 
            if(sum >= 80 && sum <= 200 && ac >= 5) {
                count++;
                let isCold = res.some(n => basket2.includes(n));
                const ballHtml = res.map((n, i) => {
                    let isConsec = (res[i-1] === n-1 || res[i+1] === n+1);
                    let c = basket2.includes(n) ? "ball ball-cold" : "ball";
                    let addClass = isConsec ? "ball-consec" : "";
                    return `<span class="${c} ${addClass}">${n}</span>`;
                }).join('');

                box.innerHTML += `<div><span class="tag ${isCold ? 'tag-cold':'tag-win'}">${isCold ? 'ì €ê²©':'ì•ˆì •'}</span>#${count} ${ballHtml} <small style="color:#555">í•©:${sum}</small></div>`;
            }
        }
    }
    window.onload = init;
</script>
