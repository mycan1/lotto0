<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì‹ ì˜ ì† - ì›ë³¸ ë¡œì§ 100% ë³µì›</title>
    <style>
        body { background-color: #0c0c0c; color: #f2c94c; font-family: 'Malgun Gothic', sans-serif; text-align: center; padding: 20px; margin: 0; }
        h1 { color: #f2c94c; font-size: 2.2rem; margin-top: 20px; font-weight: bold; cursor: pointer; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .target-box { color: #FFF; font-size: 1.1rem; margin-bottom: 20px; background: #1a1a1a; padding: 12px 15px; border-radius: 10px; display: inline-block; border: 2px solid #f2c94c; font-weight: bold; }
        .status-label { background: #262626; color: #fff; padding: 10px 20px; border-radius: 8px; border: 1px dashed #f2c94c; font-size: 0.85rem; display: inline-block; margin-bottom: 20px; }
        .btn-main { width: 100%; max-width: 400px; height: 60px; background-color: #d4a017; color: black; border: none; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; margin-bottom: 15px; box-shadow: 0 4px 0 #967111; }
        #console { width: 100%; max-width: 400px; height: 450px; margin: 0 auto; background-color: #1a1a1a; border: 2px solid #333; border-radius: 12px; padding: 15px; text-align: left; overflow-y: auto; color: #f2c94c; font-family: 'Courier New', monospace; font-size: 14px; line-height: 1.8; box-sizing: border-box; }
    </style>
</head>
<body>
    <h1 onclick="location.reload()">ì‹  ì˜ ì†</h1>
    <div class="status-label" id="system-status">ğŸ”„ ë°ì´í„° ì—°ë™ ì¤‘...</div>
    <div class="target-box" id="display-target">ğŸ¯ ì œ 1207íšŒì°¨ ë¶„ì„</div>

    <button class="btn-main" id="btn-run" onclick="generate()" disabled>ì‚¬ìš©ì ì›ë³¸ ë¡œì§ 10ê°œ ì¶”ì¶œ</button>

    <div id="console">â–¶ ì‹œìŠ¤í…œ ì¤€ë¹„ ì¤‘...</div>

    <script>
        const GITHUB_USER = "mycan1"; 
        const GITHUB_REPO = "lotto0"; 
        const RAW_URL = `https://raw.githubusercontent.com/${GITHUB_USER}/${GITHUB_REPO}/main/ë¡œë˜1206.txt`;

        let globalLottoData = [];
        let _seed = 1208; // ì‚¬ì¥ë‹˜ ì›ë³¸ ì‹œë“œê°’ ê³ ì •

        function seededRandom() {
            _seed = (_seed * 1664525 + 1013904223) % 4294967296;
            return _seed / 4294967296;
        }

        // [ì›ë³¸] AC ì§€ìˆ˜ ê³„ì‚°
        function calculateAC(nums) {
            let diffs = new Set();
            for(let i=0; i<6; i++) {
                for(let j=i+1; j<6; j++) diffs.add(Math.abs(nums[i]-nums[j]));
            }
            return diffs.size - 5;
        }

        // [ì›ë³¸] ì—°ë²ˆ í•„í„° (3ì—°ë²ˆ ì°¨ë‹¨, ìŒì—°ë²ˆ ì˜µì…˜)
        function isSequentialOk(nums, allowDoublePair) {
            let consecutivePairs = 0;
            for(let i=0; i<5; i++) {
                if(nums[i]+1 === nums[i+1]) {
                    if(i < 4 && nums[i+1]+1 === nums[i+2]) return false; // 3ì—°ë²ˆ ê¸ˆì§€
                    consecutivePairs++;
                    i++; 
                }
            }
            return consecutivePairs <= (allowDoublePair ? 2 : 1);
        }

        async function init() {
            try {
                const res = await fetch(`${RAW_URL}?t=${Date.now()}`);
                const text = await res.text();
                const lines = text.trim().split('\n');
                globalLottoData = lines.map(l => l.split(',').map(Number));
                document.getElementById('system-status').innerHTML = "âœ… ì›ë³¸ ë°ì´í„° ë¶„ì„ ì™„ë£Œ";
                document.getElementById('btn-run').disabled = false;
                document.getElementById('console').innerHTML = "â–¶ ì‚¬ì¥ë‹˜ ì›ë³¸ ë¡œì§ì´ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤.\n--------------------------";
            } catch(e) {
                document.getElementById('system-status').innerHTML = "âŒ ì—°ê²° ì‹¤íŒ¨";
            }
        }

        function generate() {
            const box = document.getElementById('console');
            box.innerHTML = "";
            
            // [ì›ë³¸] ê³µê²©/ì•ˆì • ëª¨ë“œ ì§„ë‹¨
            let clusterCount = 0;
            for(let i=0; i<5; i++) {
                let row = globalLottoData[i].slice(1,7).sort((a,b)=>a-b);
                if(row.some((n, idx) => n+1 === row[idx+1])) clusterCount++;
            }
            let isAttackTiming = clusterCount >= 3;
            box.innerHTML += `ì‹œìŠ¤í…œ ì§„ë‹¨: ${isAttackTiming ? '[ê³µê²©ëª¨ë“œ]' : '[ì•ˆì •ëª¨ë“œ]'}\nâ€» ì‚¬ìš©ì ì›ë³¸ ë¡œì§ 100% ê°€ë™\n\n`;

            // [ì›ë³¸] í’€ ìƒì„±
            const lastWeekNums = globalLottoData[0].slice(1,7);
            const recent30 = globalLottoData.slice(0,30).flatMap(r => r.slice(1,7));
            const counts = {};
            recent30.forEach(n => counts[n] = (counts[n] || 0) + 1);
            
            const elitePool = Object.keys(counts).filter(n => counts[n] >= 2 && counts[n] <= 4).map(Number);
            const longTermMissingPool = Array.from({length:45}, (_,i)=>i+1).filter(n => !counts[n]);
            longTermMissingPool.sort(() => seededRandom() - 0.5);

            let results = [];

            // 1~7ë²ˆ ì¡°í•©: ì›ë³¸ í†µê³„ (í•©ê³„ 100-170, AC 5-8, í™€ì§ 2:4~4:2)
            while(results.length < 7) {
                let candidate = Array.from({length:45}, (_,i)=>i+1).sort(() => seededRandom() - 0.5).slice(0,6).sort((a,b)=>a-b);
                let sum = candidate.reduce((a,b)=>a+b, 0);
                let ac = calculateAC(candidate);
                let odd = candidate.filter(n => n % 2 !== 0).length;
                if(sum >= 100 && sum <= 170 && ac >= 5 && ac <= 8 && [2,3,4].includes(odd) && isSequentialOk(candidate, false)) {
                    results.push({tag: "ì›ë³¸í†µê³„", nums: candidate});
                }
            }

            // 8~10ë²ˆ ì¡°í•©: ì§‘ì¤‘íƒ€ê²© (ë¯¸ì¶œìˆ˜ ê°•ì œ ì‚½ì… 1, 2, 3ê°œ)
            for(let i=1; i<=3; i++) {
                let useDouble = isAttackTiming && (i < 3);
                while(true) {
                    let mPicks = longTermMissingPool.slice(0, i);
                    let pool = [...new Set([...elitePool, ...lastWeekNums])];
                    let base = pool.sort(() => seededRandom() - 0.5).slice(0, 6 - i);
                    let candidate = [...new Set([...base, ...mPicks])].sort((a,b)=>a-b);
                    
                    if(candidate.length === 6 && candidate.reduce((a,b)=>a+b,0) >= 100 && candidate.reduce((a,b)=>a+b,0) <= 170 && isSequentialOk(candidate, useDouble)) {
                        results.push({tag: `ì§‘ì¤‘íƒ€ê²©_${i}`, nums: candidate, isDouble: !isSequentialOk(candidate, false)});
                        break;
                    }
                }
            }

            results.forEach((res, idx) => {
                let line = `${res.tag.padEnd(10)} | ${res.nums.join(', ')}`;
                if(res.isDouble) line += " (ìŒ)";
                box.innerHTML += `<div>${idx + 1}. ${line}</div>`;
            });
        }

        init();
    </script>
</body>
</html>
