<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì‹ ì˜ ì† AI - SEED ê³ ì • ì—”ì§„</title>
    <style>
        body { background-color: #0c0c0c; color: #f2c94c; font-family: 'Malgun Gothic', sans-serif; text-align: center; padding: 20px; margin: 0; }
        h1 { color: #f2c94c; font-size: 2.2rem; margin-bottom: 10px; cursor: pointer; }
        .seed-input-container { margin-bottom: 20px; }
        #seed-val { background: #222; border: 1px solid #f2c94c; color: #fff; padding: 10px; border-radius: 5px; width: 120px; text-align: center; font-weight: bold; }
        .target-box { color: #FFF; font-size: 1.1rem; margin-bottom: 15px; background: #1a1a1a; padding: 10px 20px; border-radius: 10px; display: inline-block; border: 2px solid #f2c94c; }
        .btn-main { width: 100%; max-width: 400px; height: 60px; background: linear-gradient(145deg, #f2c94c, #d4a017); color: #000; border-radius: 8px; font-weight: bold; font-size: 18px; cursor: pointer; margin-bottom: 15px; }
        .ball { display: inline-block; width: 32px; height: 32px; line-height: 32px; text-align: center; border-radius: 50%; font-weight: bold; font-size: 14px; margin-right: 4px; color: #fff; text-shadow: 1px 1px 1px #000; }
        .b1 { background: #fbc400; } .b11 { background: #69c8f2; } .b21 { background: #ff7272; } .b31 { background: #aaa; } .b41 { background: #b0d840; }
        #console { width: 100%; max-width: 400px; height: 500px; margin: 0 auto; background: #111; padding: 15px; text-align: left; overflow-y: auto; color: #eee; font-size: 13.5px; border-radius: 10px; border: 1px solid #333; line-height: 1.8; }
        .row-item { margin-bottom: 12px; border-bottom: 1px solid #222; padding-bottom: 8px; }
        .tag-final { color: #f2c94c; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ì‹ ì˜ ì† AI ğŸš€</h1>
    <div class="seed-input-container">
        <label style="font-size: 0.8rem; color: #888;">ìš´ëª…ì˜ ì‹œë“œê°’: </label>
        <input type="number" id="seed-val" value="777" placeholder="ìˆ«ì ì…ë ¥">
    </div>
    <div class="target-box" id="display-target">ğŸ¯ ë°ì´í„° ë¡œë”© ì¤‘...</div>

    <button class="btn-main" onclick="processIntersectionStrategy()">ì‹œë“œ ê³ ì • ì¡°í•© ì¶”ì¶œ</button>

    <div id="console">â–¶ ë¡œë˜ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ì‹œë“œë¥¼ ê³ ì •í•˜ì„¸ìš”.</div>

    <script>
        const MY_DATA_FILE = 'lotto.txt';
        let rawData = [], missingPool = [], elitePool = [], lastWeekNums = [];
        let _seed = 777;

        // [í•µì‹¬] ì‹œë“œ ê¸°ë°˜ ë‚œìˆ˜ ìƒì„± í•¨ìˆ˜ (Linear Congruential Generator)
        function seededRandom() {
            _seed = (_seed * 1664525 + 1013904223) % 4294967296;
            return _seed / 4294967296;
        }

        // ì‹œë“œ ê¸°ë°˜ ë°°ì—´ ì…”í”Œ
        function seededShuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(seededRandom() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function getAC(arr) {
            let diffs = new Set();
            for (let i = 0; i < 6; i++) for (let j = i + 1; j < 6; j++) diffs.add(Math.abs(arr[i] - arr[j]));
            return diffs.size - 5;
        }

        async function loadData() {
            try {
                const response = await fetch(MY_DATA_FILE + '?v=' + Math.random());
                const text = await response.text();
                const lines = text.trim().split('\n');
                rawData = lines.map(line => line.split(',').map(Number)).filter(row => row.length >= 7);
                let counts = {};
                rawData.slice(0, 30).forEach(row => row.slice(1,7).forEach(n => counts[n] = (counts[n]||0)+1));
                missingPool = Array.from({length:45},(_,i)=>i+1).filter(n => !counts[n]);
                elitePool = Object.keys(counts).filter(n => counts[n]>=2 && counts[n]<=5).map(Number);
                lastWeekNums = rawData[0].slice(1,7);
                document.getElementById('display-target').innerHTML = `ğŸ¯ ì œ ${rawData[0][0] + 1}íšŒì°¨ ë¶„ì„ ì—”ì§„`;
            } catch (e) { document.getElementById('console').innerHTML = "âŒ lotto.txt ì—°ë™ í•„ìš”"; }
        }

        function processIntersectionStrategy() {
            _seed = parseInt(document.getElementById('seed-val').value) || 777; // ì…ë ¥í•œ ì‹œë“œë¡œ ì´ˆê¸°í™”
            const box = document.getElementById('console');
            box.innerHTML = `â–¶ ì‹œë“œ(${_seed}) ê³ ì • ë¶„ì„ ê²°ê³¼\n\n`;
            
            let poolForIntersection = [];
            let results = [];

            for (let i = 1; i <= 9; i++) {
                let safety = 0;
                while (safety < 10000) {
                    safety++;
                    let mCount = (i <= 5) ? 0 : (i <= 8 ? 1 : 2);
                    
                    // Math.random ëŒ€ì‹  seededRandom ì‚¬ìš©
                    let tempMissing = [...missingPool];
                    seededShuffle(tempMissing);
                    let mPick = tempMissing.slice(0, mCount);
                    
                    let base = Array.from({length:45},(_,idx)=>idx+1);
                    seededShuffle(base);
                    let others = base.filter(n => !mPick.includes(n)).slice(0, 6 - mCount);
                    
                    let candidate = [...mPick, ...others].sort((a,b)=>a-b);
                    let sum = candidate.reduce((a,b)=>a+b,0);
                    let ac = getAC(candidate);

                    if (sum>=100 && sum<=180 && ac>=5) {
                        results.push({nums: candidate, tag: i<=5?"ì•ˆì •":"íƒ€ê²©"});
                        poolForIntersection.push(...candidate);
                        break;
                    }
                }
            }

            // êµì§‘í•© í•„ì‚´ê¸°
            let freq = {};
            poolForIntersection.forEach(n => freq[n] = (freq[n] || 0) + 1);
            let sortedNums = Object.keys(freq).sort((a,b) => freq[b] - freq[a]);
            let intersectionCombo = sortedNums.slice(0, 6).map(Number).sort((a,b)=>a-b);
            results.push({nums: intersectionCombo, tag: "â˜…í•„ì‚´ê¸°â˜…"});

            results.forEach((res, idx) => {
                let ballHtml = res.nums.map(n => {
                    let cls = n<=10?'b1':n<=20?'b11':n<=30?'b21':n<=40?'b31':'b41';
                    return `<span class="ball ${cls}">${n}</span>`;
                }).join("");
                box.innerHTML += `<div class="row-item"><span class="tag-final">[${res.tag}]</span> ${ballHtml}</div>`;
            });
        }

        window.onload = loadData;
    </script>
</body>
</html>
